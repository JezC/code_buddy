<html>
<head>
  <title>Code Buddy</title>
  <link href="stylesheets/tutorial.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="stylesheets/coderay.css" media="screen" rel="stylesheet" type="text/css" />
  <script src="javascripts/jquery.js" type="text/javascript"></script>
  <script src="javascripts/underscore.js" type="text/javascript"></script>
  <script src="javascripts/backbone.js" type="text/javascript"></script>
</head>
<body>
<div class="banner">
  <h1><img src="images/buddy.jpeg"/>&nbsp;CodeBuddy</h1>

  <div>
    <div>hit up to scroll up</div>
    <div>hit down to scroll down</div>
  </div>

</div>

<div class="code_buddy">
  <ul id="stack"></ul>
  <div id='code'></div>
</div>

<script src="javascripts/code_buddy.js" type="text/javascript"></script>
<script>

  // HARDCODED STACK ... will come from server...
  var stack = new Stack({
    selected:      1, 
    addressesJson: [
      {"line":29,  "file":"/Users/hi/lib/code_buddy/app.rb", "code":'some code here'},
      {"line":1032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'different code here'},
      {"line":1032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more code here'},
      {"line":103, "file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more different code here'},
      {"line":2032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still more code here'},
      {"line":3032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'again code here'},
      {"line":4032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still going code here'},
      {"line":5032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'blah code here'},
      {"line":6032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'ooh code here'},
      {"line":7032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'look at this code here'},{"line":1032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more code here'},
      {"line":103, "file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more different code here'},
      {"line":2032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still more code here'},
      {"line":3032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'again code here'},
      {"line":4032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still going code here'},
      {"line":5032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'blah code here'},
      {"line":6032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'ooh code here'},
      {"line":7032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'look at this code here'},{"line":1032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more code here'},
      {"line":103, "file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more different code here'},
      {"line":2032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still more code here'},
      {"line":3032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'again code here'},
      {"line":4032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still going code here'},
      {"line":5032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'blah code here'},
      {"line":6032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'ooh code here'},
      {"line":7032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'look at this code here'},{"line":1032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more code here'},
      {"line":103, "file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more different code here'},
      {"line":2032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still more code here'},
      {"line":3032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'again code here'},
      {"line":4032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still going code here'},
      {"line":5032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'blah code here'},
      {"line":6032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'ooh code here'},
      {"line":7032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'look at this code here'},{"line":1032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more code here'},
      {"line":103, "file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more different code here'},
      {"line":2032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still more code here'},
      {"line":3032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'again code here'},
      {"line":4032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still going code here'},
      {"line":5032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'blah code here'},
      {"line":6032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'ooh code here'},
      {"line":7032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'look at this code here'},{"line":1032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more code here'},
      {"line":103, "file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more different code here'},
      {"line":2032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still more code here'},
      {"line":3032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'again code here'},
      {"line":4032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still going code here'},
      {"line":5032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'blah code here'},
      {"line":6032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'ooh code here'},
      {"line":7032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'look at this code here'},{"line":1032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more code here'},
      {"line":103, "file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more different code here'},
      {"line":2032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still more code here'},
      {"line":3032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'again code here'},
      {"line":4032,"file":"/ems/sinatra-1.1.0/ems/sinatra-1.1.0/ems/sinatra-1.1.0/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still going code here'},
      {"line":5032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'blah code here'},
      {"line":6032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'ooh code here'},
      {"line":7032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'look at this code here'},{"line":1032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more code here'},
      {"line":103, "file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'more different code here'},
      {"line":2032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still more code here'},
      {"line":3032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'again code here'},
      {"line":4032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'still going code here'},
      {"line":5032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'blah code here'},
      {"line":6032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'ooh code here'},
      {"line":7032,"file":"/ems/sinatra-1.1.0/lib/sinatra/base.rb", "code":'look at this code here'},
      {"line":6,   "file":"script/rails",                           "code":"more and more code"}
    ]
    });

  var stackView = new StackView({model: stack});
  stackView.render();

  // Why don't backbone events work???
  $(document).keydown(function(event) {
    var ret = stack.view.changeSelectionOnArrow(event)
    var offset = $(stack.selectedAddress().view.el).offset().top
    var windowHeight = $(window).height()
    if (offset > windowHeight + $(window).scrollTop()) {
      $('html,body').animate({scrollTop: offset - 200}, 500);
    } else if (offset < $(window).scrollTop()) {
      $('html,body').animate({scrollTop: offset - 500}, 500);
    }
    return ret;
  })


</script>
</body>
</html>
