<html>
<head>
  <title>Code Buddy</title>
  <link href="stylesheets/code_buddy.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="stylesheets/coderay.css" media="screen" rel="stylesheet" type="text/css" />
  <script src="javascripts/jquery.js" type="text/javascript"></script>
  <script src="javascripts/underscore.js" type="text/javascript"></script>
  <script src="javascripts/backbone.js" type="text/javascript"></script>
</head>
<body>
<div class="banner">
  <h1><img src="images/buddy.jpeg"/>&nbsp;CodeBuddy</h1>

  <div>
    <div>hit up to scroll up</div>
    <div>hit down to scroll down</div>
  </div>

</div>

<div class="code_buddy">
  <ul id="stack"></ul>
  <div id='code'></div>
</div>

<script src="javascripts/code_buddy.js" type="text/javascript"></script>
<script>

  var stack = new Stack(<%= @stack.to_json %>);

  var stackView = new StackView({model: stack});
  stackView.render();

  // Why don't backbone events work???
  $(document).keydown(function(event) {
    var ret = stack.view.changeSelectionOnArrow(event)
    var offset = $(stack.selectedAddress().view.el).offset().top
    var windowHeight = $(window).height()
    if (offset > windowHeight + $(window).scrollTop()) {
      $('html,body').animate({scrollTop: offset - 200}, 500);
    } else if (offset < $(window).scrollTop()) {
      $('html,body').animate({scrollTop: offset - 500}, 500);
    }
    return ret;
  })


</script>
</body>
</html>
